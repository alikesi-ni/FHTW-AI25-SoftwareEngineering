<h2>Search Posts by User</h2>

<div class="form-row">
  <label>Username:</label>
  <input
    type="text"
    [(ngModel)]="username"
    name="username"
    placeholder="Enter username"
  />
  <button
    (click)="search()"
    [disabled]="loading || !username.trim()">
    {{ loading ? 'Searching...' : 'Search' }}
  </button>
</div>

@if (error) {
  <p class="error">{{ error }}</p>
}

@if (!loading && posts.length > 0) {
  <h3>Results</h3>

  @for (p of posts; track p.id) {
    <div class="post-card">
      <p><strong>ID:</strong> {{ p.id }}</p>

      @if (p.image) {
        <div class="post-image">
          <img
            [src]="'http://localhost:8000/static/' + p.image"
            alt="Post image {{ p.id }}"
            class="post-image-img"
          />
        </div>
      }

      <p><strong>Comment:</strong> {{ p.comment }}</p>
      <p><strong>Username:</strong> {{ p.username }}</p>
      <p><strong>Created at:</strong> {{ p.created_at }}</p>
      <hr />
    </div>
  }
}

@if (!loading && !error && posts.length === 0 && username.trim()) {
  <p>No posts found for this user.</p>
}
