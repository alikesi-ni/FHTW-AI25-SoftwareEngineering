<h2 class="mb-3">Create Post</h2>

<div class="card mb-3">
  <div class="card-body">
    <form class="row g-3" (ngSubmit)="submit()">
      <!-- Image (optional) -->
      <div class="col-12">
        <label class="form-label" for="image">Image</label>
        <input
          #imageInput
          id="image"
          type="file"
          class="form-control"
          (change)="onFileSelected($event)"
          accept="image/png, image/jpeg"
        />
        <div class="form-text">
          Optional. PNG or JPG only.
        </div>
      </div>

      <!-- Content (textarea, optional but required together with image) -->
      <div class="col-12">
        <label class="form-label" for="content">Content</label>
        <textarea
          id="content"
          class="form-control"
          [(ngModel)]="form.content"
          name="content"
          rows="4"
          maxlength="280"
          placeholder="What do you want to share?"
        ></textarea>
        <div class="form-text">
          Up to 280 characters. Either some content or an image (or both) is required.
        </div>
      </div>

      <!-- Username (required) -->
      <div class="col-12">
        <label class="form-label" for="username">
          Username <span class="text-danger">*</span>
        </label>
        <input
          id="username"
          type="text"
          class="form-control"
          [(ngModel)]="form.username"
          name="username"
          placeholder="Your name"
        />
      </div>

      <!-- Button -->
      <div class="col-12 d-flex justify-content-end">
        <button
          type="submit"
          class="btn btn-primary"
          [disabled]="loading || !canSubmit()">
          {{ loading ? 'Creating...' : 'Create' }}
        </button>
      </div>
    </form>
  </div>
</div>

@if (result) {
  <div class="alert alert-success mt-3">{{ result }}</div>
}

@if (error) {
  <div class="alert alert-danger mt-3">{{ error }}</div>
}
